---
title: "titulo"
author: "nombres"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Cargar los paquetes necesarios acá
# Cargar el paquete readr
library(readr)
library(datos)
library(dplyr)
library(ggplot2)

# Leer el archivo vinos.csv
vinos <- read_csv("datos/vinos.csv")

```

## Introducción
Los datos analizados corresponden a reseñas de vinos publicadas en la revista WineEnthusiast. Estas reseñas abarcan un período de tiempo específico y proporcionan información valiosa sobre diversos aspectos de los vinos, como su origen, variedad, puntuación, precio y otros detalles relevantes.

Los datos fueron obtenidos de una adaptación del conjunto de datos original disponible en Kaggle, el cual ha sido traducido y modificado para su análisis. 
El objetivo de estos datos es permitir el estudio y análisis de las características de los vinos, así como explorar posibles relaciones entre variables como la puntuación, el precio, el país de origen y la variedad. Estos datos son de interés tanto para amantes del vino como para profesionales del sector vitivinícola, ya que proporcionan una visión general de la calidad, diversidad y distribución geográfica de los vinos reseñados.

En resumen, los datos son una recopilación de reseñas de vinos provenientes de la revista WineEnthusiast, abarcando un período de tiempo específico y brindando información detallada sobre diferentes características de los vinos analizados. Son una fuente rica y relevante para el estudio y análisis del mundo del vino.

## Exploración de los datos

```{r}
# Código para cargar o leer los datos
# Mostrar las primeras filas del conjunto de datos
head(vinos)

# Obtener la cantidad de observaciones y variables
observaciones <- nrow(vinos)
variables <- ncol(vinos)

# Mostrar la cantidad de observaciones y variables
observaciones
variables

```
El conjunto de datos "vinos.csv" tiene un total de observaciones 129971 y 10 variables.

```{r}
# Cödigo de R acá 
# Agregá más bloques según sea necesario
# Variable "puntos"
# Calcular el valor medio y desviación estándar de la variable "puntos"
media_puntos <- mean(vinos$puntos)
desvio_puntos <- sd(vinos$puntos)

# Mostrar el valor medio y desviación estándar de la variable "puntos"
media_puntos  # Media de la variable puntos.
desvio_puntos #Desvio estandar de la variable puntos.

```
```{r}
# Calcular el valor medio y desviación estándar de la variable "precio"
media_precio <- mean(vinos$precio)
desvio_precio <- sd(vinos$precio)

```

```{r}

# Filtrar vinos de un país específico (por ejemplo, Argentina)
vinos_argentina <- vinos %>%
  filter(pais == "Argentina")

# Obtener el precio promedio por país, ignorando los valores faltantes
precio_promedio_pais <- vinos %>%
  group_by(pais) %>%
  summarize(precio_promedio = mean(precio, na.rm = TRUE))


```

## Hipótesis
¿Existe una relación entre la acidez y el nivel de alcohol en los vinos? Se podría analizar si existe alguna correlación entre la acidez y el nivel de alcohol en los vinos del conjunto de datos. Se podría investigar si los vinos con niveles más altos de alcohol tienden a tener una acidez más baja, o si hay alguna otra relación notable entre estas dos características.

¿Existe una relación entre la puntuación de un vino y su precio? Se podría explorar si los vinos con puntuaciones más altas tienden a tener precios más elevados, o si hay alguna tendencia particular en la relación entre estas dos variables.


```{r}
ggplot(data = vinos, aes(x = precio, y = puntos)) +
  geom_point() +
  labs(x = "Precio", y = "puntos") +
  ggtitle("Relación entre Puntuacion y Precio de los Vinos")
```


¿Cuáles son los países con la mayor cantidad de vinos en el conjunto de datos? Se podría analizar la distribución de los vinos según el país de origen y determinar cuáles son los países más representados en el conjunto.
```{r}

# Calcular la cantidad de vinos por país y almacenar los resultados en un objeto llamado "conteo_paises"

conteo_paises <- table(vinos$pais)
conteo_paises 

# Crear un dataframe con los datos de conteo de países
datos_paises <- data.frame(pais = names(conteo_paises), cantidad = as.numeric(conteo_paises))
top_paises <- head(names(sort(conteo_paises, decreasing = TRUE)), 10)
vinos_top <- vinos[vinos$pais %in% top_paises, ]


ggplot(data = data.frame(pais = vinos_top$pais), aes(x = pais)) +
  geom_bar(fill = "steelblue") +
  labs(x = "Paísesaaa", y = "Cantidad de Vinos") +
  ggtitle("Top 10 Países que Consumen Vinos")

```


¿Cuál es la variedad de uva más común en los vinos del conjunto de datos? Se podría investigar la frecuencia de las diferentes variedades de uva presentes en los vinos y determinar cuál es la más prevalente.

```{r}

# Calcular la frecuencia de las variedades de uva
frecuencia_variedades <- table(vinos$variedad)

# Convertir la tabla de frecuencias en un dataframe
  df_variedades <- data.frame(variedad = names(frecuencia_variedades),
                           frecuencia = as.numeric(frecuencia_variedades))

# Ordenar las variedades de uva por frecuencia descendente
  df_variedades <- df_variedades[order(df_variedades$frecuencia, decreasing = TRUE), ]

# Graficar las frecuencias de las variedades de uva
  #ggplot(data = df_variedades, aes(x = reorder(variedad, -frecuencia), y = frecuencia)) +
  #geom_bar(stat = "identity", fill = "steelblue") +
  #labs(x = "Variedad de Uva", y = "Frecuencia") +
  #ggtitle("Variedades de Uva más Comunes en los Vinos")

  
  # Seleccionar las 3 variedades de uva con mayor frecuencia
  top_3_variedades <- df_variedades[1:3,]

# Ordenar las variedades de uva por frecuencia ascendente
top_3_variedades <- top_3_variedades[order(top_3_variedades$frecuencia), ]

# Reordenar las variedades de uva en el gráfico
df_variedades$variedad <- factor(df_variedades$variedad, levels = top_3_variedades$variedad)

# Graficar las frecuencias de las 3 variedades de uva más frecuentes
  ggplot(data = na.omit(df_variedades), aes(x = variedad, y = frecuencia)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(x = "Variedad de Uva", y = "Frecuencia") +
  ggtitle("Top 3 Variedades de Uvas más Frecuentes")


```



